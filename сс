Справочник Студенты: Модуль менеджера

Процедура Печать(ТабДок, Ссылка) Экспорт

//{{_КОНСТРУКТОР_ПЕЧАТИ(Печать)

Макет = Справочники.Студенты.ПолучитьМакет("Печать");

Запрос = Новый Запрос;

Запрос.Текст =

"ВЫБРАТЬ

| Студенты.Код,

| Студенты.Курс,

| Студенты.Наименование,

| Студенты.СведенияОСтуденте.(

| НомерСтуденческогоБилета

| )

|ИЗ

| Справочник.Студенты КАК Студенты

|ГДЕ

| Студенты.Ссылка В (&Ссылка)";

Запрос.Параметры.Вставить("Ссылка", Ссылка);

Выборка = Запрос.Выполнить().Выбрать();

ОбластьЗаголовок = Макет.ПолучитьОбласть("Заголовок");

Шапка = Макет.ПолучитьОбласть("Шапка");

ОбластьСведенияОСтудентеШапка = Макет.ПолучитьОбласть("СведенияОСтудентеШапка");

ОбластьСведенияОСтуденте = Макет.ПолучитьОбласть("СведенияОСтуденте");

ТабДок.Очистить();

ВставлятьРазделительСтраниц = Ложь;

Пока Выборка.Следующий() Цикл

Если ВставлятьРазделительСтраниц Тогда

ТабДок.ВывестиГоризонтальныйРазделительСтраниц();

КонецЕсли;

ТабДок.Вывести(ОбластьЗаголовок);

Шапка.Параметры.Заполнить(Выборка);

ТабДок.Вывести(Шапка, Выборка.Уровень());

ТабДок.Вывести(ОбластьСведенияОСтудентеШапка);

ВыборкаСведенияОСтуденте = Выборка.СведенияОСтуденте.Выбрать();

Пока ВыборкаСведенияОСтуденте.Следующий() Цикл

ОбластьСведенияОСтуденте.Параметры.Заполнить(ВыборкаСведенияОСтуденте);

ТабДок.Вывести(ОбластьСведенияОСтуденте, ВыборкаСведенияОСтуденте.Уровень());

КонецЦикла;

ВставлятьРазделительСтраниц = Истина;

КонецЦикла;

//}}

КонецПроцедуры

Справочник Группы: Модуль менеджера

Процедура Печать(ТабДок, Ссылка) Экспорт

//{{_КОНСТРУКТОР_ПЕЧАТИ(Печать)

Макет = Справочники.Группы.ПолучитьМакет("Печать");

Запрос = Новый Запрос;

Запрос.Текст =

"ВЫБРАТЬ

| Группы.Код,

| Группы.Наименование

|ИЗ

| Справочник.Группы КАК Группы

|ГДЕ

| Группы.Ссылка В (&Ссылка)";

Запрос.Параметры.Вставить("Ссылка", Ссылка);

Выборка = Запрос.Выполнить().Выбрать();

ОбластьЗаголовок = Макет.ПолучитьОбласть("Заголовок");

Шапка = Макет.ПолучитьОбласть("Шапка");

ТабДок.Очистить();

ВставлятьРазделительСтраниц = Ложь;

Пока Выборка.Следующий() Цикл

Если ВставлятьРазделительСтраниц Тогда

ТабДок.ВывестиГоризонтальныйРазделительСтраниц();

КонецЕсли;

ТабДок.Вывести(ОбластьЗаголовок);

Шапка.Параметры.Заполнить(Выборка);

ТабДок.Вывести(Шапка, Выборка.Уровень());

ВставлятьРазделительСтраниц = Истина;

КонецЦикла;

//}}

КонецПроцедуры

Документ ЗачетнаяВедомость: Модуль менеджера

Процедура Печать(ТабДок, Ссылка) Экспорт

//{{_КОНСТРУКТОР_ПЕЧАТИ(Печать)

Макет = Документы.ЗачетнаяВедомость.ПолучитьМакет("Печать");

Запрос = Новый Запрос;

Запрос.Текст =

"ВЫБРАТЬ

| ЗачетнаяВедомость.Группа,

| ЗачетнаяВедомость.Дата,

| ЗачетнаяВедомость.Дисциплина,

| ЗачетнаяВедомость.Номер,

| ЗачетнаяВедомость.Преподаватель,

| ЗачетнаяВедомость.Оценки.(

| НомерСтроки,

| Студент,

| Оценка

| )

|ИЗ

| Документ.ЗачетнаяВедомость КАК ЗачетнаяВедомость

|ГДЕ

| ЗачетнаяВедомость.Ссылка В (&Ссылка)";

Запрос.Параметры.Вставить("Ссылка", Ссылка);

Выборка = Запрос.Выполнить().Выбрать();

ОбластьЗаголовок = Макет.ПолучитьОбласть("Заголовок");

Шапка = Макет.ПолучитьОбласть("Шапка");

ОбластьОценкиШапка = Макет.ПолучитьОбласть("ОценкиШапка");

ОбластьОценки = Макет.ПолучитьОбласть("Оценки");

ТабДок.Очистить();

ВставлятьРазделительСтраниц = Ложь;

Пока Выборка.Следующий() Цикл

Если ВставлятьРазделительСтраниц Тогда

ТабДок.ВывестиГоризонтальныйРазделительСтраниц();

КонецЕсли;

ТабДок.Вывести(ОбластьЗаголовок);

Шапка.Параметры.Заполнить(Выборка);

ТабДок.Вывести(Шапка, Выборка.Уровень());

ТабДок.Вывести(ОбластьОценкиШапка);

ВыборкаОценки = Выборка.Оценки.Выбрать();

Пока ВыборкаОценки.Следующий() Цикл

ОбластьОценки.Параметры.Заполнить(ВыборкаОценки);

ТабДок.Вывести(ОбластьОценки, ВыборкаОценки.Уровень());

КонецЦикла;

ВставлятьРазделительСтраниц = Истина;

КонецЦикла;

//}}

КонецПроцедуры

Команда Печать: Модуль команды

&НаКлиенте

Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)

//{{_КОНСТРУКТОР_ПЕЧАТИ(Печать)

ТабДок = Новый ТабличныйДокумент;

Печать(ТабДок, ПараметрКоманды);

ТабДок.ОтображатьСетку = Ложь;

ТабДок.Защита = Ложь;

ТабДок.ТолькоПросмотр = Ложь;

ТабДок.ОтображатьЗаголовки = Ложь;

ТабДок.Показать();

//}}

КонецПроцедуры

&НаСервере

Процедура Печать(ТабДок, ПараметрКоманды)

Документы.ЗачетнаяВедомость.Печать(ТабДок, ПараметрКоманды);

КонецПроцедуры

Отчет СоставГрупп: Запрос

ВЫБРАТЬ

Студенты.Наименование,

Студенты.СведенияОСтуденте.(

НомерСтуденческогоБилета

),

Студенты.Владелец

ИЗ

Справочник.Студенты КАК Студенты

Отчет ОплатаОбучения: Запрос

ВЫБРАТЬ

СуммаКОплатеСрезПоследних.Студент,

СуммаКОплатеСрезПоследних.Сумма

ИЗ

РегистрСведений.СуммаКОплате.СрезПоследних КАК СуммаКОплатеСрезПоследних
